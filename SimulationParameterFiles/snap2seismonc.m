clear all

set_mfiles_path
%MFILEROOT='/net/fs01/data/tibet/code/mfiles';
%path([MFILEROOT '/fun-spool'],path);
%path([MFILEROOT '/saclab'],path);

REGION_ROOT='./';
%event_name='2001.300.05.35.42';
event_name='2003.230.09.03.02';
OUTPUT_ROOT=[REGION_ROOT '/' event_name];

OUTPUT_ROOT='./';
fnm_conf=[OUTPUT_ROOT '/' 'SeisFD3D.conf'];
pnm_out =[OUTPUT_ROOT '/' 'output/'];
pnm_info=[OUTPUT_ROOT '/' 'input/'];
pnm_metric=[OUTPUT_ROOT '/' 'input/'];

recv{001}={64.877   102.740 9000E3 'CD.KMI'    25.123   102.740}  ;
recv{002}={60.300    91.150 9000E3 'CD.LSA'    29.700    91.150}  ;
recv{003}={64.877   102.740 9000E3 'CD.KMI'    25.123   102.740}  ;
recv{004}={60.300    91.150 9000E3 'CD.LSA'    29.700    91.150}  ;
recv{005}={64.877   102.740 9000E3 'IC.KMI'    25.123   102.740}  ;
recv{006}={60.297    91.127 9000E3 'IC.LSA'    29.703    91.127}  ;
recv{007}={60.297    91.127 9000E3 'IC.LSA'    29.703    91.127}  ;
recv{008}={64.877   102.740 9000E3 'IC.KMI'    25.123   102.740}  ;
recv{009}={62.452    90.766 9000E3 'XA.BUMT'    27.548    90.766}  ;
recv{010}={62.917    89.550 9000E3 'XA.CHUK'    27.083    89.550}  ;
recv{011}={62.508    89.644 9000E3 'XA.DOCH'    27.492    89.644}  ;
recv{012}={62.433    89.320 9000E3 'XA.PARO'    27.567    89.320}  ;
recv{013}={62.251    89.731 9000E3 'XA.TASH'    27.749    89.731}  ;
recv{014}={57.753    91.688 9000E3 'XC.AMDO'    32.247    91.688}  ;
recv{015}={55.480    92.707 9000E3 'XC.ERDO'    34.520    92.707}  ;
recv{016}={60.233    94.050 9000E3 'XC.GANZ'    29.767    94.050}  ;
recv{017}={60.298    91.128 9000E3 'XC.LHSA'    29.702    91.128}  ;
recv{018}={55.522   100.249 9000E3 'XC.MAQI'    34.478   100.249}  ;
recv{019}={58.976    91.700 9000E3 'XC.SANG'    31.024    91.700}  ;
recv{020}={56.989    97.015 9000E3 'XC.USHU'    33.011    97.015}  ;
recv{021}={56.552    91.904 9000E3 'XC.WNDO'    33.448    91.904}  ;
recv{022}={60.766    88.851 9000E3 'XC.XIGA'    29.234    88.851}  ;
recv{023}={58.742    92.090 9000E3 'XE.ES01'    31.258    92.090}  ;
recv{024}={59.001    92.540 9000E3 'XE.ES02'    30.999    92.540}  ;
recv{025}={59.247    92.859 9000E3 'XE.ES03'    30.753    92.859}  ;
recv{026}={59.354    93.250 9000E3 'XE.ES04'    30.646    93.250}  ;
recv{027}={58.321    92.402 9000E3 'XE.ES05'    31.679    92.402}  ;
recv{028}={58.341    93.199 9000E3 'XE.ES06'    31.659    93.199}  ;
recv{029}={58.411    93.346 9000E3 'XE.ES06A'    31.589    93.346}  ;
recv{030}={58.797    94.170 9000E3 'XE.ES06B'    31.203    94.170}  ;
recv{031}={58.519    93.700 9000E3 'XE.ES07'    31.481    93.700}  ;
recv{032}={58.716    93.836 9000E3 'XE.ES08'    31.284    93.836}  ;
recv{033}={58.091    93.058 9000E3 'XE.ES09'    31.909    93.058}  ;
recv{034}={58.162    93.792 9000E3 'XE.ES10'    31.838    93.792}  ;
recv{035}={58.093    94.136 9000E3 'XE.ES11'    31.907    94.136}  ;
recv{036}={58.414    94.706 9000E3 'XE.ES12'    31.586    94.706}  ;
recv{037}={58.463    95.282 9000E3 'XE.ES13'    31.537    95.282}  ;
recv{038}={58.746    95.901 9000E3 'XE.ES14'    31.254    95.901}  ;
recv{039}={58.807    96.498 9000E3 'XE.ES15'    31.193    96.498}  ;
recv{040}={58.817    97.018 9000E3 'XE.ES16'    31.183    97.018}  ;
recv{041}={58.729    97.548 9000E3 'XE.ES17'    31.271    97.548}  ;
recv{042}={58.699    97.962 9000E3 'XE.ES18'    31.301    97.962}  ;
recv{043}={59.187    95.711 9000E3 'XE.ES19'    30.813    95.711}  ;
recv{044}={59.271    96.104 9000E3 'XE.ES20'    30.729    96.104}  ;
recv{045}={59.090    96.338 9000E3 'XE.ES21'    30.910    96.338}  ;
recv{046}={59.193    96.699 9000E3 'XE.ES22'    30.807    96.699}  ;
recv{047}={59.309    97.261 9000E3 'XE.ES23'    30.691    97.261}  ;
recv{048}={59.498    97.137 9000E3 'XE.ES24'    30.502    97.137}  ;
recv{049}={59.880    97.303 9000E3 'XE.ES25'    30.120    97.303}  ;
recv{050}={60.042    97.511 9000E3 'XE.ES26'    29.958    97.511}  ;
recv{051}={60.359    97.896 9000E3 'XE.ES27'    29.641    97.896}  ;
recv{052}={60.280    98.427 9000E3 'XE.ES28'    29.720    98.427}  ;
recv{053}={59.991    96.691 9000E3 'XE.ES29'    30.009    96.691}  ;
recv{054}={60.682    97.186 9000E3 'XE.ES30'    29.318    97.186}  ;
recv{055}={60.494    96.756 9000E3 'XE.ES31'    29.506    96.756}  ;
recv{056}={60.242    96.102 9000E3 'XE.ES32'    29.758    96.102}  ;
recv{057}={60.227    95.700 9000E3 'XE.ES33'    29.773    95.700}  ;
recv{058}={60.091    95.472 9000E3 'XE.ES34'    29.909    95.472}  ;
recv{059}={60.039    94.780 9000E3 'XE.ES35'    29.961    94.780}  ;
recv{060}={60.192    93.907 9000E3 'XE.ES36'    29.808    93.907}  ;
recv{061}={60.103    93.515 9000E3 'XE.ES37'    29.897    93.515}  ;
recv{062}={59.977    92.965 9000E3 'XE.ES38'    30.023    92.965}  ;
recv{063}={60.125    92.621 9000E3 'XE.ES39'    29.875    92.621}  ;
recv{064}={60.293    92.149 9000E3 'XE.ES40'    29.707    92.149}  ;
recv{065}={60.810    91.759 9000E3 'XE.ES41'    29.190    91.759}  ;
recv{066}={61.101    91.943 9000E3 'XE.ES42'    28.899    91.943}  ;
recv{067}={60.959    92.226 9000E3 'XE.ES43'    29.041    92.226}  ;
recv{068}={60.932    93.384 9000E3 'XE.ES44'    29.068    93.384}  ;
recv{069}={60.928    93.386 9000E3 'XE.ES44A'    29.072    93.386}  ;
recv{070}={60.883    93.782 9000E3 'XE.ES45'    29.117    93.782}  ;
recv{071}={60.754    94.258 9000E3 'XE.ES46'    29.246    94.258}  ;
recv{072}={60.517    94.415 9000E3 'XE.ES47'    29.483    94.415}  ;
recv{073}={60.512    94.579 9000E3 'XE.ES48'    29.488    94.579}  ;
recv{074}={59.621    90.911 9000E3 'XR.BB05'    30.379    90.911}  ;
recv{075}={59.870    90.548 9000E3 'XR.BB08'    30.130    90.548}  ;
recv{076}={60.003    90.414 9000E3 'XR.BB10'    29.997    90.414}  ;
recv{077}={60.632    90.185 9000E3 'XR.BB14'    29.368    90.185}  ;
recv{078}={61.070    89.744 9000E3 'XR.BB18'    28.930    89.744}  ;
recv{079}={61.273    89.664 9000E3 'XR.BB20'    28.727    89.664}  ;
recv{080}={61.514    89.659 9000E3 'XR.BB23'    28.486    89.659}  ;
recv{081}={60.892    89.252 9000E3 'XR.BB34'    29.108    89.252}  ;
recv{082}={60.184    90.757 9000E3 'XR.BB36'    29.816    90.757}  ;
recv{083}={59.155    91.137 9000E3 'XR.SP01'    30.845    91.137}  ;
recv{084}={60.337    90.350 9000E3 'XR.SP12'    29.663    90.350}  ;
recv{085}={61.822    89.303 9000E3 'XR.SP25'    28.178    89.303}  ;
recv{086}={62.329    89.076 9000E3 'XR.SP27'    27.671    89.076}  ;
recv{087}={58.021    90.913 9000E3 'XR.DONG'    31.979    90.913}  ;
recv{088}={58.101    89.932 9000E3 'XR.LUMP'    31.899    89.932}  ;
recv{089}={58.011    91.706 9000E3 'XR.NASE'    31.989    91.706}  ;
recv{090}={59.621    90.913 9000E3 'XR.NING'    30.379    90.913}  ;
recv{091}={58.217    87.385 9000E3 'XR.NYMA'    31.783    87.385}  ;
recv{092}={58.978    91.700 9000E3 'XR.SANG2'    31.022    91.700}  ;
recv{093}={59.474    90.103 9000E3 'XR.ST00'    30.526    90.103}  ;
recv{094}={59.350    90.133 9000E3 'XR.ST01'    30.650    90.133}  ;
recv{095}={59.213    90.249 9000E3 'XR.ST02'    30.787    90.249}  ;
recv{096}={59.153    90.192 9000E3 'XR.ST03'    30.847    90.192}  ;
recv{097}={59.041    90.192 9000E3 'XR.ST04'    30.959    90.192}  ;
recv{098}={58.960    90.174 9000E3 'XR.ST05'    31.040    90.174}  ;
recv{099}={58.876    90.097 9000E3 'XR.ST06'    31.124    90.097}  ;
recv{100}={58.774    90.070 9000E3 'XR.ST07'    31.226    90.070}  ;
recv{101}={58.701    90.031 9000E3 'XR.ST08'    31.299    90.031}  ;
recv{102}={58.579    90.004 9000E3 'XR.ST09'    31.421    90.004}  ;
recv{103}={58.507    90.008 9000E3 'XR.ST10'    31.493    90.008}  ;
recv{104}={58.418    89.981 9000E3 'XR.ST11'    31.582    89.981}  ;
recv{105}={58.374    89.883 9000E3 'XR.ST12'    31.626    89.883}  ;
recv{106}={58.360    89.789 9000E3 'XR.ST12A'    31.640    89.789}  ;
recv{107}={58.326    89.717 9000E3 'XR.ST13'    31.674    89.717}  ;
recv{108}={58.274    89.703 9000E3 'XR.ST13A'    31.726    89.703}  ;
recv{109}={58.230    89.708 9000E3 'XR.ST14'    31.770    89.708}  ;
recv{110}={58.201    89.661 9000E3 'XR.ST14A'    31.799    89.661}  ;
recv{111}={58.165    89.640 9000E3 'XR.ST15'    31.835    89.640}  ;
recv{112}={58.150    89.577 9000E3 'XR.ST15A'    31.850    89.577}  ;
recv{113}={58.112    89.498 9000E3 'XR.ST16'    31.888    89.498}  ;
recv{114}={58.080    89.420 9000E3 'XR.ST16A'    31.920    89.420}  ;
recv{115}={58.061    89.358 9000E3 'XR.ST17'    31.939    89.358}  ;
recv{116}={58.048    89.310 9000E3 'XR.ST17A'    31.952    89.310}  ;
recv{117}={58.035    89.269 9000E3 'XR.ST18'    31.965    89.269}  ;
recv{118}={58.025    89.205 9000E3 'XR.ST18A'    31.975    89.205}  ;
recv{119}={57.942    89.191 9000E3 'XR.ST19'    32.058    89.191}  ;
recv{120}={57.897    89.195 9000E3 'XR.ST19A'    32.103    89.195}  ;
recv{121}={57.832    89.142 9000E3 'XR.ST20'    32.168    89.142}  ;
recv{122}={57.771    89.134 9000E3 'XR.ST21'    32.229    89.134}  ;
recv{123}={57.725    89.097 9000E3 'XR.ST21A'    32.275    89.097}  ;
recv{124}={57.667    89.116 9000E3 'XR.ST22'    32.333    89.116}  ;
recv{125}={57.625    89.100 9000E3 'XR.ST22A'    32.375    89.100}  ;
recv{126}={57.577    89.108 9000E3 'XR.ST23'    32.423    89.108}  ;
recv{127}={57.529    89.050 9000E3 'XR.ST23A'    32.471    89.050}  ;
recv{128}={57.520    88.984 9000E3 'XR.ST24'    32.480    88.984}  ;
recv{129}={57.463    88.940 9000E3 'XR.ST25'    32.537    88.940}  ;
recv{130}={57.388    88.954 9000E3 'XR.ST25A'    32.612    88.954}  ;
recv{131}={57.339    88.916 9000E3 'XR.ST26'    32.661    88.916}  ;
recv{132}={57.302    88.867 9000E3 'XR.ST26A'    32.698    88.867}  ;
recv{133}={57.256    88.851 9000E3 'XR.ST27'    32.744    88.851}  ;
recv{134}={57.178    88.848 9000E3 'XR.ST28'    32.822    88.848}  ;
recv{135}={57.066    88.853 9000E3 'XR.ST29'    32.934    88.853}  ;
recv{136}={56.971    88.854 9000E3 'XR.ST30'    33.029    88.854}  ;
recv{137}={56.865    88.877 9000E3 'XR.ST31'    33.135    88.877}  ;
recv{138}={56.758    88.835 9000E3 'XR.ST32'    33.242    88.835}  ;
recv{139}={56.673    88.832 9000E3 'XR.ST33'    33.327    88.832}  ;
recv{140}={56.591    88.764 9000E3 'XR.ST34'    33.409    88.764}  ;
recv{141}={56.523    88.736 9000E3 'XR.ST35'    33.477    88.736}  ;
recv{142}={56.478    88.602 9000E3 'XR.ST36'    33.522    88.602}  ;
recv{143}={56.394    88.523 9000E3 'XR.ST37'    33.606    88.523}  ;
recv{144}={56.346    88.505 9000E3 'XR.ST38'    33.654    88.505}  ;
recv{145}={56.236    88.400 9000E3 'XR.ST39'    33.764    88.400}  ;
recv{146}={56.185    88.307 9000E3 'XR.ST40'    33.815    88.307}  ;
recv{147}={57.908    88.306 9000E3 'XR.W1'    32.092    88.306}  ;
recv{148}={58.040    86.663 9000E3 'XR.W2'    31.960    86.663}  ;
recv{149}={59.000   102.347 9000E3 'YA.MC01'    31.000   102.347}  ;
recv{150}={59.619   103.429 9000E3 'YA.MC02'    30.381   103.429}  ;
recv{151}={59.998   102.489 9000E3 'YA.MC03'    30.002   102.489}  ;
recv{152}={59.945   101.481 9000E3 'YA.MC04'    30.055   101.481}  ;
recv{153}={60.008   100.221 9000E3 'YA.MC05'    29.992   100.221}  ;
recv{154}={61.062    99.794 9000E3 'YA.MC06'    28.938    99.794}  ;
recv{155}={60.955   100.421 9000E3 'YA.MC07'    29.045   100.421}  ;
recv{156}={61.004   101.512 9000E3 'YA.MC08'    28.996   101.512}  ;
recv{157}={61.041   102.764 9000E3 'YA.MC09'    28.959   102.764}  ;
recv{158}={61.024   103.871 9000E3 'YA.MC10'    28.976   103.871}  ;
recv{159}={61.669   103.124 9000E3 'YA.MC11'    28.331   103.124}  ;
recv{160}={62.337   102.208 9000E3 'YA.MC12'    27.663   102.208}  ;
recv{161}={62.258   100.756 9000E3 'YA.MC13'    27.741   100.756}  ;
recv{162}={62.135    99.735 9000E3 'YA.MC14'    27.865    99.735}  ;
recv{163}={63.241    99.988 9000E3 'YA.MC15'    26.759    99.988}  ;
recv{164}={62.818   103.633 9000E3 'YA.MC16'    27.182   103.633}  ;
recv{165}={63.529   101.744 9000E3 'YA.MC17'    26.471   101.744}  ;
recv{166}={63.940   103.197 9000E3 'YA.MC18'    26.060   103.197}  ;
recv{167}={64.271   101.896 9000E3 'YA.MC19'    25.729   101.896}  ;
recv{168}={64.222   100.609 9000E3 'YA.MC20'    25.778   100.609}  ;
recv{169}={64.512    99.643 9000E3 'YA.MC21'    25.488    99.643}  ;
recv{170}={65.468   100.241 9000E3 'YA.MC22'    24.532   100.241}  ;
recv{171}={65.066   101.510 9000E3 'YA.MC23'    24.934   101.510}  ;
recv{172}={65.834   102.830 9000E3 'YA.MC24'    24.166   102.830}  ;
recv{173}={65.114   103.671 9000E3 'YA.MC25'    24.886   103.671}  ;
recv{174}={63.516    87.267 9000E3 'YL.BIRA'    26.484    87.267}  ;
recv{175}={62.123    85.891 9000E3 'YL.BUNG'    27.877    85.891}  ;
recv{176}={61.335    87.116 9000E3 'YL.DINX'    28.665    87.116}  ;
recv{177}={63.162    86.632 9000E3 'YL.GAIG'    26.838    86.632}  ;
recv{178}={62.952    87.324 9000E3 'YL.HILE'    27.048    87.324}  ;
recv{179}={63.090    87.923 9000E3 'YL.ILAM'    26.910    87.923}  ;
recv{180}={63.289    85.924 9000E3 'YL.JANA'    26.711    85.924}  ;
recv{181}={62.366    86.230 9000E3 'YL.JIRI'    27.634    86.230}  ;
recv{182}={60.860    87.592 9000E3 'YL.LAZE'    29.140    87.592}  ;
recv{183}={61.329    87.855 9000E3 'YL.MAZA'    28.671    87.855}  ;
recv{184}={61.244    86.161 9000E3 'YL.MNBU'    28.756    86.161}  ;
recv{185}={61.340    86.413 9000E3 'YL.NAIL'    28.660    86.413}  ;
recv{186}={62.197    86.715 9000E3 'YL.NAMC'    27.803    86.715}  ;
recv{187}={61.845    85.978 9000E3 'YL.NLMU'    28.155    85.978}  ;
recv{188}={60.698    87.244 9000E3 'YL.ONRN'    29.302    87.244}  ;
recv{189}={62.485    86.584 9000E3 'YL.PHAP'    27.515    86.584}  ;
recv{190}={62.850    87.764 9000E3 'YL.PHID'    27.150    87.764}  ;
recv{191}={61.805    86.828 9000E3 'YL.RBSH'    28.195    86.828}  ;
recv{192}={60.503    86.437 9000E3 'YL.RC14'    29.497    86.437}  ;
recv{193}={62.696    86.548 9000E3 'YL.RUMJ'    27.304    86.548}  ;
recv{194}={60.671    85.232 9000E3 'YL.SAGA'    29.329    85.232}  ;
recv{195}={61.091    88.021 9000E3 'YL.SAJA'    28.909    88.021}  ;
recv{196}={62.789    85.909 9000E3 'YL.SIND'    27.211    85.909}  ;
recv{197}={60.576    86.729 9000E3 'YL.SSAN'    29.424    86.729}  ;
recv{198}={62.294    85.761 9000E3 'YL.SUKT'    27.706    85.761}  ;
recv{199}={62.400    85.557 9000E3 'YL.THAK'    27.600    85.557}  ;
recv{200}={62.679    87.195 9000E3 'YL.TUML'    27.321    87.195}  ;
recv{201}={61.259    85.690 9000E3 'YL.XIXI'    28.741    85.690}  ;
recv{202}={61.596    86.113 9000E3 'YL.YALA'    28.404    86.113}  ;
recv{203}={64.877   102.740 9000E3 'CD.KMI'    25.123   102.740}  ;
recv{204}={60.300    91.150 9000E3 'CD.LSA'    29.700    91.150}  ;
recv{205}={60.297    91.127 9000E3 'IC.LSA'    29.703    91.127}  ;
recv{206}={64.877   102.740 9000E3 'IC.KMI'    25.123   102.740}  ;
recv{207}={62.452    90.766 9000E3 'XA.BUMT'    27.548    90.766}  ;
recv{208}={62.917    89.550 9000E3 'XA.CHUK'    27.083    89.550}  ;
recv{209}={62.433    89.320 9000E3 'XA.PARO'    27.567    89.320}  ;
recv{210}={62.251    89.731 9000E3 'XA.TASH'    27.749    89.731}  ;
recv{211}={57.753    91.688 9000E3 'XC.AMDO'    32.247    91.688}  ;
recv{212}={55.480    92.707 9000E3 'XC.ERDO'    34.520    92.707}  ;
recv{213}={60.233    94.050 9000E3 'XC.GANZ'    29.767    94.050}  ;
recv{214}={60.298    91.128 9000E3 'XC.LHSA'    29.702    91.128}  ;
recv{215}={55.522   100.249 9000E3 'XC.MAQI'    34.478   100.249}  ;
recv{216}={58.976    91.700 9000E3 'XC.SANG'    31.024    91.700}  ;
recv{217}={56.989    97.015 9000E3 'XC.USHU'    33.011    97.015}  ;
recv{218}={56.552    91.904 9000E3 'XC.WNDO'    33.448    91.904}  ;
recv{219}={60.766    88.851 9000E3 'XC.XIGA'    29.234    88.851}  ;
recv{220}={58.742    92.090 9000E3 'XE.ES01'    31.258    92.090}  ;
recv{221}={59.001    92.540 9000E3 'XE.ES02'    30.999    92.540}  ;
recv{222}={59.247    92.859 9000E3 'XE.ES03'    30.753    92.859}  ;
recv{223}={59.354    93.250 9000E3 'XE.ES04'    30.646    93.250}  ;
recv{224}={58.321    92.402 9000E3 'XE.ES05'    31.679    92.402}  ;
recv{225}={58.341    93.199 9000E3 'XE.ES06'    31.659    93.199}  ;
recv{226}={58.519    93.700 9000E3 'XE.ES07'    31.481    93.700}  ;
recv{227}={58.716    93.836 9000E3 'XE.ES08'    31.284    93.836}  ;
recv{228}={58.091    93.058 9000E3 'XE.ES09'    31.909    93.058}  ;
recv{229}={58.162    93.792 9000E3 'XE.ES10'    31.838    93.792}  ;
recv{230}={58.093    94.136 9000E3 'XE.ES11'    31.907    94.136}  ;
recv{231}={58.414    94.706 9000E3 'XE.ES12'    31.586    94.706}  ;
recv{232}={58.463    95.282 9000E3 'XE.ES13'    31.537    95.282}  ;
recv{233}={58.746    95.901 9000E3 'XE.ES14'    31.254    95.901}  ;
recv{234}={58.807    96.498 9000E3 'XE.ES15'    31.193    96.498}  ;
recv{235}={58.817    97.018 9000E3 'XE.ES16'    31.183    97.018}  ;
recv{236}={58.729    97.548 9000E3 'XE.ES17'    31.271    97.548}  ;
recv{237}={58.699    97.962 9000E3 'XE.ES18'    31.301    97.962}  ;
recv{238}={59.187    95.711 9000E3 'XE.ES19'    30.813    95.711}  ;
recv{239}={59.271    96.104 9000E3 'XE.ES20'    30.729    96.104}  ;
recv{240}={59.090    96.338 9000E3 'XE.ES21'    30.910    96.338}  ;
recv{241}={59.193    96.699 9000E3 'XE.ES22'    30.807    96.699}  ;
recv{242}={59.309    97.261 9000E3 'XE.ES23'    30.691    97.261}  ;
recv{243}={59.498    97.137 9000E3 'XE.ES24'    30.502    97.137}  ;
recv{244}={59.880    97.303 9000E3 'XE.ES25'    30.120    97.303}  ;
recv{245}={60.042    97.511 9000E3 'XE.ES26'    29.958    97.511}  ;
recv{246}={60.359    97.896 9000E3 'XE.ES27'    29.641    97.896}  ;
recv{247}={60.280    98.427 9000E3 'XE.ES28'    29.720    98.427}  ;
recv{248}={59.991    96.691 9000E3 'XE.ES29'    30.009    96.691}  ;
recv{249}={60.682    97.186 9000E3 'XE.ES30'    29.318    97.186}  ;
recv{250}={60.494    96.756 9000E3 'XE.ES31'    29.506    96.756}  ;
recv{251}={60.242    96.102 9000E3 'XE.ES32'    29.758    96.102}  ;
recv{252}={60.227    95.700 9000E3 'XE.ES33'    29.773    95.700}  ;
recv{253}={60.091    95.472 9000E3 'XE.ES34'    29.909    95.472}  ;
recv{254}={60.039    94.780 9000E3 'XE.ES35'    29.961    94.780}  ;
recv{255}={60.192    93.907 9000E3 'XE.ES36'    29.808    93.907}  ;
recv{256}={60.103    93.515 9000E3 'XE.ES37'    29.897    93.515}  ;
recv{257}={59.977    92.965 9000E3 'XE.ES38'    30.023    92.965}  ;
recv{258}={60.125    92.621 9000E3 'XE.ES39'    29.875    92.621}  ;
recv{259}={60.293    92.149 9000E3 'XE.ES40'    29.707    92.149}  ;
recv{260}={60.810    91.759 9000E3 'XE.ES41'    29.190    91.759}  ;
recv{261}={61.101    91.943 9000E3 'XE.ES42'    28.899    91.943}  ;
recv{262}={60.959    92.226 9000E3 'XE.ES43'    29.041    92.226}  ;
recv{263}={60.883    93.782 9000E3 'XE.ES45'    29.117    93.782}  ;
recv{264}={60.754    94.258 9000E3 'XE.ES46'    29.246    94.258}  ;
recv{265}={60.517    94.415 9000E3 'XE.ES47'    29.483    94.415}  ;
recv{266}={60.512    94.579 9000E3 'XE.ES48'    29.488    94.579}  ;
recv{267}={59.621    90.911 9000E3 'XR.BB05'    30.379    90.911}  ;
recv{268}={59.870    90.548 9000E3 'XR.BB08'    30.130    90.548}  ;
recv{269}={60.003    90.414 9000E3 'XR.BB10'    29.997    90.414}  ;
recv{270}={60.632    90.185 9000E3 'XR.BB14'    29.368    90.185}  ;
recv{271}={61.070    89.744 9000E3 'XR.BB18'    28.930    89.744}  ;
recv{272}={61.273    89.664 9000E3 'XR.BB20'    28.727    89.664}  ;
recv{273}={61.514    89.659 9000E3 'XR.BB23'    28.486    89.659}  ;
recv{274}={60.892    89.252 9000E3 'XR.BB34'    29.108    89.252}  ;
recv{275}={60.184    90.757 9000E3 'XR.BB36'    29.816    90.757}  ;
recv{276}={59.155    91.137 9000E3 'XR.SP01'    30.845    91.137}  ;
recv{277}={61.822    89.303 9000E3 'XR.SP25'    28.178    89.303}  ;
recv{278}={62.329    89.076 9000E3 'XR.SP27'    27.671    89.076}  ;
recv{279}={58.021    90.913 9000E3 'XR.DONG'    31.979    90.913}  ;
recv{280}={58.011    91.706 9000E3 'XR.NASE'    31.989    91.706}  ;
recv{281}={59.474    90.103 9000E3 'XR.ST00'    30.526    90.103}  ;
recv{282}={59.350    90.133 9000E3 'XR.ST01'    30.650    90.133}  ;
recv{283}={59.153    90.192 9000E3 'XR.ST03'    30.847    90.192}  ;
recv{284}={59.041    90.192 9000E3 'XR.ST04'    30.959    90.192}  ;
recv{285}={58.960    90.174 9000E3 'XR.ST05'    31.040    90.174}  ;
recv{286}={58.876    90.097 9000E3 'XR.ST06'    31.124    90.097}  ;
recv{287}={58.774    90.070 9000E3 'XR.ST07'    31.226    90.070}  ;
recv{288}={58.701    90.031 9000E3 'XR.ST08'    31.299    90.031}  ;
recv{289}={58.579    90.004 9000E3 'XR.ST09'    31.421    90.004}  ;
recv{290}={58.507    90.008 9000E3 'XR.ST10'    31.493    90.008}  ;
recv{291}={58.418    89.981 9000E3 'XR.ST11'    31.582    89.981}  ;
recv{292}={58.374    89.883 9000E3 'XR.ST12'    31.626    89.883}  ;
recv{293}={58.230    89.708 9000E3 'XR.ST14'    31.770    89.708}  ;
recv{294}={58.165    89.640 9000E3 'XR.ST15'    31.835    89.640}  ;
recv{295}={58.112    89.498 9000E3 'XR.ST16'    31.888    89.498}  ;
recv{296}={58.061    89.358 9000E3 'XR.ST17'    31.939    89.358}  ;
recv{297}={58.035    89.269 9000E3 'XR.ST18'    31.965    89.269}  ;
recv{298}={57.942    89.191 9000E3 'XR.ST19'    32.058    89.191}  ;
recv{299}={57.832    89.142 9000E3 'XR.ST20'    32.168    89.142}  ;
recv{300}={57.771    89.134 9000E3 'XR.ST21'    32.229    89.134}  ;
recv{301}={57.667    89.116 9000E3 'XR.ST22'    32.333    89.116}  ;
recv{302}={57.577    89.108 9000E3 'XR.ST23'    32.423    89.108}  ;
recv{303}={57.520    88.984 9000E3 'XR.ST24'    32.480    88.984}  ;
recv{304}={57.463    88.940 9000E3 'XR.ST25'    32.537    88.940}  ;
recv{305}={57.339    88.916 9000E3 'XR.ST26'    32.661    88.916}  ;
recv{306}={57.256    88.851 9000E3 'XR.ST27'    32.744    88.851}  ;
recv{307}={57.178    88.848 9000E3 'XR.ST28'    32.822    88.848}  ;
recv{308}={57.066    88.853 9000E3 'XR.ST29'    32.934    88.853}  ;
recv{309}={56.971    88.854 9000E3 'XR.ST30'    33.029    88.854}  ;
recv{310}={56.865    88.877 9000E3 'XR.ST31'    33.135    88.877}  ;
recv{311}={56.758    88.835 9000E3 'XR.ST32'    33.242    88.835}  ;
recv{312}={56.673    88.832 9000E3 'XR.ST33'    33.327    88.832}  ;
recv{313}={56.591    88.764 9000E3 'XR.ST34'    33.409    88.764}  ;
recv{314}={56.523    88.736 9000E3 'XR.ST35'    33.477    88.736}  ;
recv{315}={56.478    88.602 9000E3 'XR.ST36'    33.522    88.602}  ;
recv{316}={56.394    88.523 9000E3 'XR.ST37'    33.606    88.523}  ;
recv{317}={56.346    88.505 9000E3 'XR.ST38'    33.654    88.505}  ;
recv{318}={56.236    88.400 9000E3 'XR.ST39'    33.764    88.400}  ;
recv{319}={56.185    88.307 9000E3 'XR.ST40'    33.815    88.307}  ;
recv{320}={57.908    88.306 9000E3 'XR.W1'    32.092    88.306}  ;
recv{321}={59.000   102.347 9000E3 'YA.MC01'    31.000   102.347}  ;
recv{322}={59.619   103.429 9000E3 'YA.MC02'    30.381   103.429}  ;
recv{323}={59.998   102.489 9000E3 'YA.MC03'    30.002   102.489}  ;
recv{324}={59.945   101.481 9000E3 'YA.MC04'    30.055   101.481}  ;
recv{325}={60.008   100.221 9000E3 'YA.MC05'    29.992   100.221}  ;
recv{326}={61.062    99.794 9000E3 'YA.MC06'    28.938    99.794}  ;
recv{327}={60.955   100.421 9000E3 'YA.MC07'    29.045   100.421}  ;
recv{328}={61.004   101.512 9000E3 'YA.MC08'    28.996   101.512}  ;
recv{329}={61.041   102.764 9000E3 'YA.MC09'    28.959   102.764}  ;
recv{330}={61.024   103.871 9000E3 'YA.MC10'    28.976   103.871}  ;
recv{331}={61.669   103.124 9000E3 'YA.MC11'    28.331   103.124}  ;
recv{332}={62.337   102.208 9000E3 'YA.MC12'    27.663   102.208}  ;
recv{333}={62.258   100.756 9000E3 'YA.MC13'    27.741   100.756}  ;
recv{334}={62.135    99.735 9000E3 'YA.MC14'    27.865    99.735}  ;
recv{335}={63.241    99.988 9000E3 'YA.MC15'    26.759    99.988}  ;
recv{336}={62.818   103.633 9000E3 'YA.MC16'    27.182   103.633}  ;
recv{337}={63.529   101.744 9000E3 'YA.MC17'    26.471   101.744}  ;
recv{338}={63.940   103.197 9000E3 'YA.MC18'    26.060   103.197}  ;
recv{339}={64.271   101.896 9000E3 'YA.MC19'    25.729   101.896}  ;
recv{340}={64.222   100.609 9000E3 'YA.MC20'    25.778   100.609}  ;
recv{341}={64.512    99.643 9000E3 'YA.MC21'    25.488    99.643}  ;
recv{342}={65.468   100.241 9000E3 'YA.MC22'    24.532   100.241}  ;
recv{343}={65.066   101.510 9000E3 'YA.MC23'    24.934   101.510}  ;
recv{344}={65.834   102.830 9000E3 'YA.MC24'    24.166   102.830}  ;
recv{345}={65.114   103.671 9000E3 'YA.MC25'    24.886   103.671}  ;
recv{346}={63.516    87.267 9000E3 'YL.BIRA'    26.484    87.267}  ;
recv{347}={62.123    85.891 9000E3 'YL.BUNG'    27.877    85.891}  ;
recv{348}={61.335    87.116 9000E3 'YL.DINX'    28.665    87.116}  ;
recv{349}={63.162    86.632 9000E3 'YL.GAIG'    26.838    86.632}  ;
recv{350}={62.952    87.324 9000E3 'YL.HILE'    27.048    87.324}  ;
recv{351}={63.090    87.923 9000E3 'YL.ILAM'    26.910    87.923}  ;
recv{352}={62.366    86.230 9000E3 'YL.JIRI'    27.634    86.230}  ;
recv{353}={60.860    87.592 9000E3 'YL.LAZE'    29.140    87.592}  ;
recv{354}={61.329    87.855 9000E3 'YL.MAZA'    28.671    87.855}  ;
recv{355}={61.244    86.161 9000E3 'YL.MNBU'    28.756    86.161}  ;
recv{356}={61.340    86.413 9000E3 'YL.NAIL'    28.660    86.413}  ;
recv{357}={62.485    86.584 9000E3 'YL.PHAP'    27.515    86.584}  ;
recv{358}={62.850    87.764 9000E3 'YL.PHID'    27.150    87.764}  ;
recv{359}={61.805    86.828 9000E3 'YL.RBSH'    28.195    86.828}  ;
recv{360}={60.503    86.437 9000E3 'YL.RC14'    29.497    86.437}  ;
recv{361}={62.696    86.548 9000E3 'YL.RUMJ'    27.304    86.548}  ;
recv{362}={60.671    85.232 9000E3 'YL.SAGA'    29.329    85.232}  ;
recv{363}={61.091    88.021 9000E3 'YL.SAJA'    28.909    88.021}  ;
recv{364}={62.789    85.909 9000E3 'YL.SIND'    27.211    85.909}  ;
recv{365}={60.576    86.729 9000E3 'YL.SSAN'    29.424    86.729}  ;
recv{366}={62.294    85.761 9000E3 'YL.SUKT'    27.706    85.761}  ;
recv{367}={62.400    85.557 9000E3 'YL.THAK'    27.600    85.557}  ;
recv{368}={62.679    87.195 9000E3 'YL.TUML'    27.321    87.195}  ;
recv{369}={61.259    85.690 9000E3 'YL.XIXI'    28.741    85.690}  ;
recv{370}={61.596    86.113 9000E3 'YL.YALA'    28.404    86.113}  ;

nrecv=length(recv);
for n=1:nrecv
    NKNMLEN=length(recv{n}{4});
    xrecv(n)=recv{n}{1}/180*pi;
    yrecv(n)=recv{n}{2}/180*pi;
    clat(n)=recv{n}{1};
    lat(n)=recv{n}{5};
    lon(n)=recv{n}{2};
    stanm(1:NKNMLEN,n)=recv{n}{4};
end
NKNMLEN=size(stanm,1)
stanm1=strjust(stanm','right');

% ----------------------- parameter -----------------------
id=2;subs=[1,1,1];subc=[-1,-1,1];subt=[1,1,1];
n1=1; n2=3500; dn=1;

if 1
% -------------------- load coord --------------------------
[snapinfo]=locate_snap(fnm_conf,id,'start',subs,'count',subc,'stride',subt);
%-- get coord data
[x,y,z]=gather_coord(snapinfo,'coorddir',pnm_metric);
nx=size(x,1);ny=size(x,2);nz=size(x,3);

% --------------------- load data --------------------------
for nlayer=n1:dn:n2
nlayer

[Vx        ]=gather_snap(snapinfo,id,nlayer,'Vx','outdir',pnm_out);
[Vy        ]=gather_snap(snapinfo,id,nlayer,'Vy','outdir',pnm_out);
[Vz,t      ]=gather_snap(snapinfo,id,nlayer,'Vz','outdir',pnm_out);

V=interp2(squeeze(y),squeeze(x),squeeze(Vx),yrecv,xrecv,'cubic');
Sx(nlayer,1:nrecv)=V(1:nrecv)';

V=interp2(squeeze(y),squeeze(x),squeeze(Vy),yrecv,xrecv,'cubic');
Sy(nlayer,1:nrecv)=V(1:nrecv)';

V=interp2(squeeze(y),squeeze(x),squeeze(Vz),yrecv,xrecv,'cubic');
Sz(nlayer,1:nrecv)=V(1:nrecv)';

V=interp2(squeeze(y),squeeze(x),squeeze(Vx),yrecv,xrecv,'linear');
Wx(nlayer,1:nrecv)=V(1:nrecv)';

V=interp2(squeeze(y),squeeze(x),squeeze(Vy),yrecv,xrecv,'linear');
Wy(nlayer,1:nrecv)=V(1:nrecv)';

V=interp2(squeeze(y),squeeze(x),squeeze(Vz),yrecv,xrecv,'linear');
Wz(nlayer,1:nrecv)=V(1:nrecv)';

T(nlayer)=t;

disp([ '  retrieve ' num2str(nlayer) 'th layer(t=' num2str(t) ')']);

end

end

%T=[0:99]*0.01;
%Sx=ones([100 18]);
%Sy=Sx; Sz=Sx;

Nt=length(T);

% ------------------- save nc -----------------------------
if 1
fnm_out=[event_name '.synthetic.interp2.cubic.nc'];
%my_mode = bitor ( nc_clobber_mode, nc_64bit_offset_mode );
%nc_create_empty ( fnm_out, my_mode );
nc_create_empty(fnm_out);
nc_add_dimension(fnm_out,'number_of_station',nrecv);
nc_add_dimension(fnm_out,'time',Nt);
nc_add_dimension(fnm_out,'maxchar',NKNMLEN);

var.Nctype='float';var.Attribute=[];
var.Name='time';var.Dimension={'time'};nc_addvar(fnm_out,var);

var.Name='x';var.Dimension={'number_of_station'};nc_addvar(fnm_out,var);
var.Name='y';var.Dimension={'number_of_station'};nc_addvar(fnm_out,var);
var.Name='latitude';var.Dimension={'number_of_station'};nc_addvar(fnm_out,var);
var.Name='colatitude';var.Dimension={'number_of_station'};nc_addvar(fnm_out,var);
var.Name='longitude';var.Dimension={'number_of_station'};nc_addvar(fnm_out,var);

var.Name='Vx';var.Dimension={'number_of_station','time'};nc_addvar(fnm_out,var);
var.Name='Vy';var.Dimension={'number_of_station','time'};nc_addvar(fnm_out,var);
var.Name='Vz';var.Dimension={'number_of_station','time'};nc_addvar(fnm_out,var);

var.Nctype='char';var.Attribute=[]; var.Name='station_name';
var.Dimension={'number_of_station','maxchar'};nc_addvar(fnm_out,var);

nc_varput(fnm_out,'time',T);
nc_varput(fnm_out,'x',xrecv);
nc_varput(fnm_out,'y',yrecv);
nc_varput(fnm_out,'latitude',lat);
nc_varput(fnm_out,'colatitude',clat);
nc_varput(fnm_out,'longitude',lon);
%nc_varput(fnm_out,'station_name',permute(stanm,[2 1]));
nc_varput(fnm_out,'station_name',stanm1);

nc_varput(fnm_out,'Vx',permute(Sx,[2 1]));
nc_varput(fnm_out,'Vy',permute(Sy,[2 1]));
nc_varput(fnm_out,'Vz',permute(Sz,[2 1]));

disp('finished exporting cubic nc')
end

if 1
fnm_out=[event_name '.synthetic.interp2.linear.nc'];
%my_mode = bitor ( nc_clobber_mode, nc_64bit_offset_mode );
%nc_create_empty ( fnm_out, my_mode );
nc_create_empty(fnm_out);
nc_add_dimension(fnm_out,'number_of_station',nrecv);
nc_add_dimension(fnm_out,'time',Nt);
nc_add_dimension(fnm_out,'maxchar',NKNMLEN);

var.Nctype='float';var.Attribute=[];
var.Name='time';var.Dimension={'time'};nc_addvar(fnm_out,var);

var.Name='x';var.Dimension={'number_of_station'};nc_addvar(fnm_out,var);
var.Name='y';var.Dimension={'number_of_station'};nc_addvar(fnm_out,var);
var.Name='latitude';var.Dimension={'number_of_station'};nc_addvar(fnm_out,var);
var.Name='colatitude';var.Dimension={'number_of_station'};nc_addvar(fnm_out,var);
var.Name='longitude';var.Dimension={'number_of_station'};nc_addvar(fnm_out,var);

var.Name='Vx';var.Dimension={'number_of_station','time'};nc_addvar(fnm_out,var);
var.Name='Vy';var.Dimension={'number_of_station','time'};nc_addvar(fnm_out,var);
var.Name='Vz';var.Dimension={'number_of_station','time'};nc_addvar(fnm_out,var);

var.Nctype='char';var.Attribute=[]; var.Name='station_name';
var.Dimension={'number_of_station','maxchar'};nc_addvar(fnm_out,var);

nc_varput(fnm_out,'time',T);
nc_varput(fnm_out,'x',xrecv);
nc_varput(fnm_out,'y',yrecv);
nc_varput(fnm_out,'latitude',lat);
nc_varput(fnm_out,'colatitude',clat);
nc_varput(fnm_out,'longitude',lon);
%nc_varput(fnm_out,'station_name',permute(stanm,[2 1]));
nc_varput(fnm_out,'station_name',stanm1);

nc_varput(fnm_out,'Vx',permute(Wx,[2 1]));
nc_varput(fnm_out,'Vy',permute(Wy,[2 1]));
nc_varput(fnm_out,'Vz',permute(Wz,[2 1]));

disp('finished exporting linear nc')
end
% ------------------- save sac -----------------------------
if 0
%save seis.interpy.mat
for n=1:nrecv
    Vsac=sacb(T,S(:,n));
    sacw([event '.' recv{n}{4} '.BSY.SAC'],Vsac);
end
end
